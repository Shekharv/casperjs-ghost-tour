
<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->  <html class="no-js" lang="en"> <!--<![endif]-->
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title>CasperJS: The Ghost Tour</title>
	
	<meta name="description" content="A browser testing utility based on PhantomJS and Javascript">
	<meta name="author" content="AurÃ©lien Thieriot">
	<meta name="viewport" content="width=1024, user-scalable=no">
	
	<!-- Core and extension CSS files -->
	<link rel="stylesheet" href="./js/deck.core.css">
	<link rel="stylesheet" href="./js/goto/deck.goto.css">
	<link rel="stylesheet" href="./js/menu/deck.menu.css">
	<link rel="stylesheet" href="./js/navigation/deck.navigation.css">
	<link rel="stylesheet" href="./js/status/deck.status.css">
	<link rel="stylesheet" href="./js/hash/deck.hash.css">
	
	<!-- Style theme. More available in /themes/style/ or create your own. -->
	<link rel="stylesheet" href="./css/style/neon.css">
	
	<!-- Transition theme. More available in /themes/transition/ or create your own. -->
	<link rel="stylesheet" href="./css/transition/horizontal-slide.css">
   <style>
   #basic-code.deck-previous {
      display:none;
   }
   </style>
	<script src="./js/modernizr.custom.js"></script>
</head>

<body class="deck-container">

<section class="slide" id="title-slide">
   <h1>The Ghost Tour<h1>
   <h2>CasperJS</h2>
</section>

<section class="slide" id="what-slide">
   <h2>What is it?</h2>
   <ol style="list-style-type: square;">
      <li class="slide" id="comment-tool" style="background-color:transparent;">
         <h3>A browser testing utility, written in Javascript<h3>
      </li>
      <li class="slide" id="comment-write" style="background-color:transparent;">
         <h3>It let you write your tests in Javascript (Or coffeescript)<h3>
      </li>
      <li class="slide" id="comment-phantom" style="background-color:transparent;">
         <h3>And runs them in PhantomJS<h3>
      </li>
   </ol>
</section>

<section class="slide" id="phantom">
   <h2>PhantomJS?</h2>
   <ol style="list-style-type: square;">
      <li class="slide" style="background-color:transparent;">
         <h3>A headless webkit<h3>
      </li>
      <li class="slide" style="background-color:transparent;">
         <h3>Support Javascript<h3>
      </li>
      <li class="slide" style="background-color:transparent;">
         <h3>Handle DOM, CSS selector<h3>
      </li>
      <li class="slide" style="background-color:transparent;">
         <h3>Even Canvas and SVG<h3>
      </li>
      <li class="slide" style="background-color:transparent;">
         <h3>Allows you to take screenshots<h3>
      </li>
   </ol>
</section>

<section class="slide" id="nonode">
   <h2>no-node.js</h2>
   <ol style="list-style-type: square;">
      <li style="background-color:transparent;">
         <h3>It's not a Node.js library<h3>
      </li>
      <li style="background-color:transparent;">
         <h3>It's a standalone tool<h3>
      </li>
   </ol>
</section>

<section class="slide" id="alternatives">
   <h2>Alternatives</h2>
   <ol style="list-style-type: square;">
      <li style="background-color:transparent;">
         <h3>HTMLUnit. Headless. Reimplementation of browser capacities<h3>
      </li>
      <li style="background-color:transparent;">
         <h3>Behat / Mink. BDD oriented. Gherkin syntax + PHP. Multiple browsers.<h3>
      </li>
      <li style="background-color:transparent;">
         <h3>Selenium. Java based. Multiple browsers.<h3>
      </li>
      <li style="background-color:transparent;">
         <h3>Cucumber. BDD. Gherkin + Ruby + Selenium.<h3>
      </li>
      <li style="background-color:transparent;">
         <h3>Capybara. Multiple browsers<h3>
      </li>
      <li style="background-color:transparent;">
         <h3>etc...<h3>
      </li>
      <li style="background-color:transparent;">
         <h3>etc...<h3>
      </li>
      <li style="background-color:transparent;">
         <h3>etc...<h3>
      </li>
   </ol>
</section>

<section class="slide" id="schema">
   <h2>A Schema is worth a thousand words</h2>
   <img src="./schema.png" /> 
</section>

<section class="slide" id="advices">
   <h2>Advices on Browser testing</h2>
   <ol style="list-style-type: square;">
      <li style="background-color:transparent;">
         <h3>/!\ Only my humble opinion /!\<h3>
      </li>
      <li class="slide" style="background-color:transparent;">
         <h3>DO IT. It's important to test the whole stack<h3>
      </li>
      <li class="slide" style="background-color:transparent;">
         <h3>Integration tests should be in your CI<h3>
      </li>
      <li class="slide" style="background-color:transparent;">
         <h3>Don't try to test everything. KISS.<h3>
      </li>
      <li class="slide" style="background-color:transparent;">
         <h3>Integration tests are not here to test your design<h3>
      </li>
      <li class="slide" style="background-color:transparent;">
         <h3>Try to avoid Javascript scenarios<h3>
      </li>
      <li class="slide" style="background-color:transparent;">
         <h3>Run a complete different suite on Internet Explorer<h3>
      </li>
      <li class="slide" style="background-color:transparent;">
         <h3>Integration tests are slow. Learn to run them in parallel<h3>
      </li>
   </ol>               
</section>
   
<section class="slide" id="steps">
   <h2>Let's start - Navigation steps</h2>
   <pre>
      <code>
        var casper = require('casper').create();

        casper.<span style="color: red;">start</span>('http://google.fr/', function() {
        });

        casper.<span style="color: red;">then</span>(function() {
        });

        casper.<span style="color: red;">thenClick('element'</span>, function() {
        });

        casper.then().<span style="color: red;">repeat(2, </span>function() {
        });

        casper.<span style="color: red;">back</span>(function() {
        });

        casper.<span style="color: red;">run</span>(function() {
        });
      </code>
   </pre>
</section>

<section class="slide" id="selectors">
   <h2>CSS3 Selectors are the right... XPath</h2>
   <pre>
      <code>
      casper.thenOpen('http://domain.tld/page.html', function() {
         this.test.assertExists(<span style="color: red;">x('//*[@id="plop"]')</span>, 'the element exists');
      });
      </code>
   </pre>
   <pre>
      <code>
      casper.start('http://domain.tld/page.html', function() {
         this.test.assertExists(<span style="color: red;">'#plop'</span>, 'the element exists');
      });

      casper.then(function() {
         this.click(<span style="color: red;">'h3.r a'</span>);
      });

      casper.then(function() {
         this.<span style="color: red;">clickLabel('My link is beautiful'</span>, 'a');
      });
      </code>
   </pre>
</section>

<section class="slide" id="fills">
   <h2>Form fill and upload... upload !!</h2>
   <pre>
      <code>
         &lt;form action="/contact" <span style="color: red;">id="contact-form" enctype="multipart/form-data</span>"&gt;
             &lt;input <span style="color: red;">type="text"</span> name="subject"&gt;
             &lt;input <span style="color: red;">type="radio"</span> name="civility" value="Mr"/&gt; Mr
             &lt;input <span style="color: red;">type="radio"</span> name="civility" value="Mrs"/&gt; Mrs
             &lt;input type="text" name="name"/&gt;
             &lt;input type="email" name="email"/&gt;
             &lt;input <span style="color: red;">type="file"</span> name="attachment"/&gt;
             &lt;input type="checkbox" name="cc"/&gt; Receive a copy
             &lt;input <span style="color: red;">type="submit"</span>/>
         &lt;/form>
      </code>
   </pre>
   <pre>
      <code>
      casper.start('http://some.tld/contact.form', function() {
         this.<span style="color: red;">fill('form#contact-form'</span>, {
              'subject':    'I am watching you',
              'civility':   <span style="color: red;">'Mr',</span>
              'name':       'Chuck Norris',
              'email':      'chuck@norris.com',
              'cc':         <span style="color: red;">true,</span>
              'attachment': <span style="color: red;">'/Users/chuck/roundhousekick.doc'</span>
          }, <span style="color: red;">true</span>);
      });
      </code>
   </pre>
</section>

<section class="slide" id="waitFor">
<h2>waitFor, waitWhile</h2>
   <pre>
      <code>
      casper.<span style="color: red;">waitFor</span>(function check() {
          <span style="color: red;">// Anything !</span>
          return this.evaluate(function() {
              return document.querySelectorAll('ul.your-list li').length > 2;
          });
      }, function <span style="color: red;">then()</span> {
         <span style="color: red;">// something to execute when check() is ok</span>
         this.captureSelector('yoursitelist.png', 'ul.your-list');
      }, function <span style="color: red;">timeout()</span> {
         <span style="color: red;">// something to execute if check has failed</span>
         this.echo("I can't haz my screenshot.").exit();
      });
      </code>
   </pre>
   <pre>
      <code>
      casper.<span style="color: red;">waitForSelector('.tweet-row'</span>, function() {});
      casper.<span style="color: red;">waitWhileSelector('.selector'</span>, function() {});

      casper.<span style="color: red;">waitUntilVisible('.tweet-row'</span>, function() {});
      casper.<span style="color: red;">waitWhileVisible('.selector'</span>, function() {});

      casper.<span style="color: red;">waitForPopup(/popup\.html$/</span>, function() {});
      this.<span style="color: red;">waitForResource("foobar.png")</span>;
      </code>
   </pre>
</section>

<section class="slide" id="evaluates">
   <h2>Evaluates is a hard Worker</h2>
   <pre>
      <code>
      casper.<span style="color: red;">evaluate</span>(function(username, password) {<span style="color: blue;">
          document.querySelector('#username').value = username;
          document.querySelector('#password').value = password;
          document.querySelector('#submit').click();</span>
      }, <span style="color: red;">'sheldon.cooper', 'b4z1ng4');
      </code>
   </pre>
   <pre>
      <code>
      casper = require('casper').create {
          <span style="color: red;">clientScripts: ["includes/underscore-min.js"]</span>
      }
      </code>
   </pre>
   <pre>
      <code>
      this.test.<span style="color: red;">assertEval</span>(function(title) 
      }, 'google.fr title is "Google"', 'Google');

      this.test.<span style="color: red;">assertEvalEquals</span>(function() {
         return document.title;
      }, 'Google', 'google.fr title is "Google"');
      </code>
   </pre>
</section>

<section class="slide" id="assertions">
   <h2>Assertions</h2>
   <h4>True</h4>
</section>

<section class="slide" id="screenshots">
   <h2>Screenshots & Downloads</h2>
   <pre>
      <code>
      casper.start('http://www.weather.com/', function() {
          this.<span style="color: red;">captureSelector('weather.png', '#wx-main')</span>;
      });
      </code>
   </pre>
   <pre>
      <code>
      casper.start().<span style="color: red;">zoom(2)</span>.thenOpen('http://google.com', function() {
          this.capture('big-google.png');
      });
      </code>
   </pre>
   <pre>
      <code>
      this.<span style="color: red;">download</span>(url, 'google_company.html');
      </code>
   </pre>
</section>

<section class="slide" id="events">
   <h2>events and filters</h2>
   <pre>
      <code>
      casper.<span style="color: red;">on('open'</span>, function(<span style="color: red;">location, settings</span>) {
          casper.echo(location);
      });
      </code>
   </pre>
   <pre>
      <code>
      // listening to a custom event
      casper.<span style="color: red;">on('google.loaded'</span>, function() {
          this.echo('Google page title is ' + this.getTitle());
      });
      casper.start('http://google.com/', function() {
         // emitting a custom event
         this.<span style="color: red;">emit('google.loaded'</span>);
      });
      </code>
   </pre>
   <pre>
      <code>
      casper.<span style="color: red;">setFilter('open.location'</span>, function(<span style="color: red;">location</span>) {
         return /\?+/.test(location) ? <span style="color: red;">location += "&foo=42"</span> : location += "?foo=42";
      });
      </code>
   </pre>
</section>

<section class="slide" id="debug">
   <h2>Drawback: Debugging</h2>
   <ol style="list-style-type: square;">
      <li style="background-color:transparent;">
         <h3>From the creator himself: Debugging is hard.<h3>
      </li>
      <li style="background-color:transparent;">
         <h3>PhantomJS don't give many useful informations about the failure.<h3>
      </li>
      <li style="background-color:transparent;">
         <h3>Advice 1: Always name the functions.<h3>
      </li>
      <li style="background-color:transparent;">
         <h3>Advice 2: Use verbose mode.<h3>
      </li>
      <pre>
         <code>
         var casper = require('casper').create({<span style="color: red;">   
             verbose: true,
             logLevel: "debug"</span>
         });
         </code>
      </pre>
   </ol>
</section>

<section class="slide" id="more">
   <h2>Many more features</h2>
   <br />
   <h4><u>Assertions, Utils, ClientUtils, Casper options, Logging, etc...</u></h4>
   <br />
   <h4><u><a href="http://casperjs.org/">http://casperjs.org</a></u></h4>
   <br />
   <h4><a href="http://github.com/n1k0/casperjs">http://github.com/n1k0/casperjs</a></h4>
   <br />
   <h4><u>Integration with node.js</u></h4>
   <br />
   <h4><a href="https://github.com/WaterfallEngineering/SpookyJS">https://github.com/WaterfallEngineering/SpookyJS</a></h4>
   <h4><u>BDD</u></h4>
   <br />
   <h4><a href="https://github.com/cucumber/cucumber-js/">https://github.com/cucumber/cucumber-js/</a></h4>
   <br />
   <h4><u>PhantomJS can be run from Selenium too</u></h4>
   <br />
   <h4><a href="https://github.com/detro/ghostdriver">https://github.com/detro/ghostdriver</a></h4>
   <br />
   <h4><a href="http://phantomjs.org/">http://phantomjs.org/</a></h4>
</section>

<section class="slide" id="demo">
   <h2>Demo: Let's see some code now</h2>
   <img src="cat.jpg" />
</section>

<!-- deck.navigation snippet -->
<a href="#" class="deck-prev-link" title="Previous">&#8592;</a>
<a href="#" class="deck-next-link" title="Next">&#8594;</a>

<!-- deck.status snippet -->
<p class="deck-status">
	<span class="deck-status-current"></span>
	/
	<span class="deck-status-total"></span>
</p>

<!-- deck.goto snippet -->
<form action="." method="get" class="goto-form">
	<label for="goto-slide">Go to slide:</label>
	<input type="text" name="slidenum" id="goto-slide" list="goto-datalist">
	<datalist id="goto-datalist"></datalist>
	<input type="submit" value="Go">
</form>

<!-- deck.hash snippet -->
<a href="." title="Permalink to this slide" class="deck-permalink">#</a>


<!-- Grab CDN jQuery, with a protocol relative URL; fall back to local if offline -->
<script src="//ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.min.js"></script>
<script>window.jQuery || document.write('<script src="./js/jquery-1.7.min.js"><\/script>')</script>

<!-- Deck Core and extensions -->
<script src="./js/deck.core.js"></script>
<script src="./js/hash/deck.hash.js"></script>
<script src="./js/menu/deck.menu.js"></script>
<script src="./js/goto/deck.goto.js"></script>
<script src="./js/status/deck.status.js"></script>
<script src="./js/navigation/deck.navigation.js"></script>

<!-- Initialize the deck -->
<script>
$(function() {
	$.deck('.slide');
});
</script>

</body>
</html>
